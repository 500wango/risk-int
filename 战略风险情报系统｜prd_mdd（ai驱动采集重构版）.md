# 战略风险情报系统
## PRD & MDD（MVP / POC｜AI 驱动采集与认知重构版）

---

# 第一部分：产品需求文档（PRD）

## 1. 产品定位与目标

**产品名称**：战略风险情报系统（Strategic Risk Intelligence System）  
**阶段**：MVP / POC  
**核心能力**：
- 国别战略风险情报自动生成
- 智能合同风险识别与解释（DeepSeek）

**系统定位声明（强约束）**：
> 本系统是【风险识别与风险提示工具】，不输出法律结论，不替代律师，不构成决策或法律依据。

---

## 2. 设计理念（PRD 级新增）

### 2.1 从“爬虫工程”到“AI 认知采集”

传统国别风险系统依赖 DOM 解析与人工规则配置，存在以下问题：
- 新网站接入成本高
- 页面结构变化导致规则失效
- 非技术人员无法维护

**本系统在 MVP 阶段采用全新范式**：

> 将网页视为“文本信息载体”，而非“结构化 DOM 对象”，
> 通过 AI 对 Markdown / 纯文本进行认知理解与结构化提取。

---

## 3. 用户角色与使用场景

### 3.1 决策层用户
- 关注国别与合同中的系统性不利风险
- 关注风险逻辑是否可解释、可追溯

### 3.2 执行层用户（法务 / 风控 / 投资）
- 使用系统完成信息初筛
- 将 AI 识别结果作为人工判断的前置输入

---

## 4. MVP 建设范围与边界

### 4.1 In Scope（本期必须实现）

- AI 驱动的国别风险情报采集
- 可配置数据源管理（URL 级）
- 智能合同审核（规则 + DeepSeek）
- 风险提示可视化（条款级 / 事件级）

### 4.2 Out of Scope（明确不做）

- 自动生成法律意见或结论
- 未脱敏合同全文上云
- 用 AI 输出直接作为决策依据

---

## 5. 国别风险情报（AI 驱动采集）

### 5.1 核心流程（PRD 视角）

```
用户配置 URL
→ 系统自动采集网页
→ AI 判断相关性
→ AI 结构化提取 + 翻译
→ 风险提示生成
→ 风险看板展示
```

### 5.2 关键设计原则

- **零规则配置**：业务人员只需提供 URL
- **高抗干扰性**：自动忽略导航、广告、页脚
- **低噪音**：仅高价值信息入库

---

## 6. 智能合同审核模块（PRD 摘要）

- 本地解析合同文本
- 规则引擎初筛明显风险条款
- 强制脱敏后调用 DeepSeek
- 输出风险类型、原因与解释

> 输出始终标注：“模型识别结果，仅供参考”

---

## 7. 成功判定（PRD）

- 国别风险信息具备持续产出能力
- 合同审核可识别 ≥80% 预置高风险条款
- 客户认可“AI + 风险”的实际价值

---

# 第二部分：模型驱动开发文档（MDD）

## 1. MDD 定位声明

> 本 MDD 是用于指导工程实现与 AI 编程助手开发的【唯一工程蓝图】。

---

## 2. 总体技术架构（重构版）

---

## 2.1 MVP 技术栈与工程约束（明确锁定）

> 本章节用于 **MVP / POC 阶段工程落地**，明确默认技术选型，
> 以“最小可用、最快交付”为原则。后续版本可在不改变总体架构的前提下替换具体技术组件。

---

### 2.1.1 后端与服务框架

- **编程语言**：Python 3.10+
- **Web 框架**：FastAPI

**选型原因**：
- 与 AI / 异步 IO 生态高度兼容
- 自动生成 Swagger UI，便于调试与演示
- 代码量少，适合 MVP 快速迭代

---

### 2.1.2 网页采集与文本规范化

- **首选方案**：Crawl4AI（Python，面向 LLM 的网页采集工具）
- **备选方案**：
  - Firecrawl（开源）
  - Jina Reader API

**统一原则**：
- 不进行 DOM / CSS Selector 级解析
- 所有网页内容统一转化为 **Markdown 或纯文本**
- 作为 AI 认知层的唯一输入格式

---

### 2.1.3 大模型能力

- **云端大模型**：DeepSeek
  - Lite / Flash：语义相关性判断（可选，控成本）
  - Full：结构化提取 / 翻译 / 风险解释

**使用约束（强制）**：
- 仅发送脱敏后的文本内容
- 不保存任何云端会话与上下文

---

### 2.1.4 合同解析与规则处理

- **PDF 解析**：pdfplumber
- **DOCX 解析**：python-docx

**说明**：
- MVP 阶段不追求完美条款结构
- 目标是实现“条款级风险标注”即可

---

### 2.1.5 数据存储

- **数据库**：PostgreSQL

**存储内容**：
- AI 结构化提取结果
- 风险标签、风险提示与解释文本
- 合同条款级风险分析结果

---

### 2.1.6 前端与展示层（Demo 级）

- **前端框架**：任意轻量 Web 框架（如 React / 模板引擎）
- **样式框架**：Tailwind CSS

**设计目标**：
- 页面结构极简
- 支持风险列表展示
- 支持条款级风险高亮与解释弹窗

> MVP 阶段不追求复杂交互，仅用于功能验证与客户演示

---

### 2.1.7 明确的 MVP 工程约束

- 单用户模式
- 单国别示例
- 单合同分析
- 非并发处理
- 不包含权限、审计与多租户设计

---

## 2.2 总体技术架构（逻辑视图）

```
[数据源管理 UI]
        ↓
[采集调度器]
        ↓
[网页转 Markdown / 纯文本]
        ↓
[AI 相关性过滤（Lite）]
        ↓
[AI 通用解析器（DeepSeek）]
        ↓
[风险提示 / 结构化数据]
        ↓
[风险看板]

[合同上传]
        ↓
[本地解析 / 规则初筛]
        ↓
[脱敏模块]
        ↓
[DeepSeek 推理]
        ↓
[合同风险解释与可视化]
```

---

## 3. AI 驱动的国别风险采集模块（核心重构）

### 3.1 模块目标

- 不依赖 DOM / CSS Selector
- 不为单一网站编写解析规则
- 支持任意政府 / 能源机构公开网页

---

### 3.2 Fetch 层（采集）

**职责**：获取网页并转化为干净 Markdown

**推荐工具**（任选）：
- Crawl4AI（Python，推荐）
- Firecrawl（开源）
- Jina Reader API

**输出标准**：

```json
{
  "url": "...",
  "language": "uz",
  "markdown": "### Ministry of Energy ..."
}
```

---

### 3.3 Relevance Filter（轻量 AI 判定）

**模型**：DeepSeek Lite / Flash

**职责**：判断是否具备战略风险情报价值

**输出**：

```json
{
  "value_level": "High / Low",
  "reason": "涉及电价补贴政策调整"
}
```

Low → 丢弃，不进入后续流程

---

### 3.4 Universal Parser（通用解析器｜核心）

**模型**：DeepSeek Full

**输入**：Markdown 文本

**输出（示例）**：

```json
{
  "title": "能源补贴政策调整公告",
  "publish_date": "2025-03-01",
  "content_type": "Policy",
  "chinese_summary": "...",
  "risk_tags": ["能源政策", "电价"],
  "risk_hint": "可能影响新能源项目收益模型",
  "confidence": 0.81
}
```

> 此步骤同时完成：清洗 + 翻译 + 结构化 + 初步风险研判

---

## 4. 合同审核模块（智能合同审核｜规则 + DeepSeek）

### 4.1 模块定位

智能合同审核模块定位为：

> **合同风险识别与风险解释工具**，用于发现潜在的系统性不利条款（“毒丸条款”），
> 不输出法律结论，不替代律师判断。

该模块的目标是：
- 为法务 / 风控人员提供高质量的风险线索
- 降低人工逐条审查的时间成本
- 提前暴露组合风险与隐含逻辑风险

---

### 4.2 审核流程（MVP）

```
合同上传（PDF / DOCX）
→ 本地解析与条款切分
→ 规则引擎初筛
→ 合同内容脱敏（强制）
→ DeepSeek 大模型推理
→ 风险解释与分类
→ 合同风险可视化
```

---

### 4.3 合同解析与条款切分（本地）

**支持格式**：PDF / DOCX

**输出结构**：

```json
{
  "clause_id": "4.2",
  "clause_title": "Termination",
  "clause_text": "..."
}
```

解析目标：
- 最大限度保留合同原有逻辑顺序
- 支持条款级风险标注与高亮

---

### 4.4 规则引擎初筛（本地）

**设计原则**：规则优先、可解释、可控

**首批内置高风险规则（示例）**：
- 单方解约权
- 单方调价机制
- 定价货币与支付货币不一致
- 政府或对方免责条款
- 担保责任缺失或弱化

规则命中条款将被：
- 标记为“高关注条款”
- 优先进入大模型深度分析

---

### 4.5 合同内容脱敏模块（强制）

在调用任何云端大模型前，必须执行脱敏处理。

**脱敏范围**：
- 合同主体名称
- 金额与比例
- 地点、项目名称

**设计目标**：
- 确保商业与合规安全
- 保留风险判断所需的逻辑关系

---

### 4.6 DeepSeek 合同风险推理

**模型**：DeepSeek Full

**输入示例**：

```json
{
  "contract_type": "PPA",
  "clause_text": "<脱敏后的条款内容>",
  "risk_focus": ["政府承诺", "定价机制", "汇率", "担保", "环保"]
}
```

---

### 4.7 DeepSeek 输出规范（强约束）

```json
{
  "risk_category": "Pricing / FX",
  "risk_level": "High / Medium / Low",
  "risk_reason": "定价货币与支付货币不一致",
  "explanation": "该条款可能导致汇率波动风险由中方单边承担",
  "confidence": 0.82
}
```

> 所有输出均需标注：**“模型识别结果，仅供参考”**

---

### 4.8 合同风险汇总与展示

- 合同整体风险等级（High / Medium / Low）
- 高风险条款 Top N
- 条款级风险高亮与解释说明

该结果用于：
- 决策层快速浏览
- 执行层作为人工审核的前置材料

---


## 5. 数据存储（Demo）

- PostgreSQL
- 存储结构化结果与 AI 解释
- 不存储云端原始会话

---

## 6. MVP 验收标准（MDD）

- 新增 URL 无需配置规则即可产出结构化情报
- AI 输出可被业务人员理解
- 单页面处理 ≤ 2 分钟

---

## 7. 后续演进方向

- 私有化部署大模型
- 合同风险与国别风险联动
- 引入 AI 辅助生成采集规则（高级模式）

---

> 本文档适用于 MVP / POC 阶段，用于快速验证 AI 驱动风险情报系统的可行性与客户价值。

